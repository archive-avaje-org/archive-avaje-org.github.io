<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Strict //EN">
<html>
<head>
<title>Bug: discriminatorType = DiscriminatorType.INTEGER - A type for discriminator value [0] was not found?</title>
<link rel="shortcut icon" href="/image/favicon.ico" >
<link rel="stylesheet" type="text/css" href="/static/v2style.css" >
<!--
<link rel="stylesheet" type="text/css" href="/css/100/basestyle|syntaxhighlighter" >
-->

<!--[if lt IE 7]>
<link rel="stylesheet" type="text/css" href="/doc/ie.css" media="screen">
<![endif]-->


<meta name="Author" content="Rob">
<meta name="description" content="ran into a wee bug as follows I had a class defined as follows DiscriminatorColumn name manager type discriminatorType DiscriminatorType INTEGER DiscriminatorValue 0 public class ResourceManager extends DomainObject but I was getting the following error testStandardResourceManager com imilia bkf service QueryServiceTest Time elapsed 0 054 sec javax persistence PersistenceException A type for discriminator value 0 was not found at com avaje ebean server deploy InheritInfo readType InheritInfo java 155 at com avaje ebean server deploy BeanPropertyAssocOne Reference readSet BeanPropertyAssocOne java 316 at com avaje ebean server deploy BeanPropertyAssocOne readSet BeanPropertyAssocOne java 218 at com avaje ebean server query SqlTreeNodeBean load SqlTreeNodeBean java 228 at com avaje ebean ser">

<script type="text/javascript" src="/doc/jslib.js" ></script>
<!--
<script type="text/javascript" src="/jsl/jquery|jquery.corner|mygoo|app|shCore|shBrushJava|shBrushProperty|shBrushSql" ></script>
-->

<script type="text/javascript">
 $(document).ready(function(){
	$(".topic").corner("12px");
	$("a.action").corner("8px hover");
	$("div.example").corner("5px");
	$(".reqrlogin").hide();

	//dp.SyntaxHighlighter.ClipboardSwf = '/flash/clipboard.swf';
	dp.SyntaxHighlighter.HighlightAll('code');

 });
</script>

<!-- component('cn=app.comp.LoginEnable') -->




</head>

<body>
<form action='/bugdetail-154.html' method="post" id="GLOBAL_ACTION">
<input type='hidden' name='_WOGA_CONTROLLER' >
<input type='hidden' name='_WOGA_METHOD' >
<input type='hidden' name='_WOGA_PARAM' >
<input type='hidden' name='_WOGA_RENDER' >
<a id="top"></a>
<div id="headwrap">
<div id="headmax">
<div id="menuuser">
<!-- component('cn=app.comp.UserStatus') -->
</div>
<img id="logo" src="/image/logo-avaje.gif" width="127" height="50" alt="avaje logo">
<div style="clear:both;"></div>
</div>
</div><!-- end of headwrap -->

<div id="head2wrap">
<div id="head2max">
<table summary="layout">
<tr>
<td align="center">
<div id="menutab" style="">
<a id="m0" href="/" class="popmenu"><span>home</span></a>
<a id="m1" href="/ebean/documentation.html" class="popmenu"><span>documentation</span></a>
<a id="m4" href="/download.html" class="popmenu"><span>downloads</span></a>
<a id="m6" href="http://groups.google.com/group/ebean" class="popmenu"><span>google group</span></a>
<a id="m2" href="/forum.html" class="popmenu"><span>forums<img src="/image/menuDownH6_3.gif" width="11" height="11" alt=""></span></a>
<a id="m3" href="/bug.html" class="popmenu"><span>bugs<img src="/image/menuDownH6_3.gif" width="11" height="11" alt=""></span></a>
<a id="m5" href="/feedback.html" class="popmenu"><span>feedback</span></a>
</div>
</td>
</tr>
</table>
</div>
</div>

<div id="bodywrap">
<div id="bodymax">
<div id="content">
<div id="pageBody">
<div id="breadcrumb">
&nbsp;
</div>






<div class="breadcrumb">
<img src="/image/smallhome.gif"> <a href="index.html">Home</a> &raquo; <a href="bug.html">Bugs</a> &raquo; BUG 154 : discriminatorType = DiscriminatorType.INTEGER - A type for discriminator value [0] was not found?
</div>


<!-- bug header info -->




<div id="app.comp.BugDetailComp">

<div class="pageactions">
<!--
<input type="button" style="width:12em;" class="btn requser" value="Add Comment" onclick="j('#bugDetailForm').show();j('#f_title').focus();">
<input type="button" style="width:12em;" class="btn requser" value="Create a new Bug" onclick="gotoURL('bugnew.html');">
-->
</div>

<table class="formlayout">
<tr>
<td colspan="6" class="heading">&nbsp;<span class="xheading">Bug 154 : discriminatorType = DiscriminatorType.INTEGER - A type for discriminator value [0] was not found? </span></td>
</tr>
<tr>
<td width="15%" class="label">Priority&nbsp;</td><td><div class="fieldmargin"><span class="field">High</span></div></td>
<td class="label">Reported Version&nbsp;</td><td><div class="fieldmargin"><span class="field">&nbsp;</span></div></td>
<td class="label">Logged By&nbsp;</td><td><div class="fieldmargin"><span class="field">Rob</span></div></td>
</tr>

<tr>
<td class="label">Status&nbsp;</td><td><div class="fieldmargin"><span class="field">Fixed</span></div></td>
<td class="label">Fixed Version&nbsp;</td><td><div class="fieldmargin"><span class="field">2.1.0</span></div></td>
<td class="label">Assigned To&nbsp;</td><td><div class="fieldmargin"><span class="field">&nbsp;</span></div></td>
</tr>

<tr>
<td class="label">Product&nbsp;</td><td><div class="fieldmargin"><span class="field">Ebean - core</span></div></td>
<td class="label">Duplicate Of&nbsp;</td><td><div class="fieldmargin"><span class="field">&nbsp;</span></div></td>
<td class="label">Created&nbsp;</td><td><div class="fieldmargin"><span class="field">15/09/2009</span></div></td>
</tr>

<tr>
<td class="label">Updated&nbsp;</td><td><div class="fieldmargin"><span class="field">15/09/2009</span></div></td>
<td class="label">Type&nbsp;</td><td><div class="fieldmargin"><span class="field">Bug</span></div></td>
<td class="label">&nbsp;</td><td></td>
</tr>

<tr>
<td class="label">Attachments&nbsp;</td>
<td colspan="5">
<div class="attachments">
<div class="fieldmargin">
<span class="field" style="width:100%;">
No attachments</span>
</div>
</div>
</td>
</tr>

<tr>
<td colspan="6"><div class="fieldmargin"><span class="field"><p>ran into a wee bug as follows <br/>I had a class defined as follows<br/>@DiscriminatorColumn(name = "manager_type", discriminatorType = DiscriminatorType.INTEGER)<br/>@DiscriminatorValue("0")<br/>public class ResourceManager extends DomainObject {</p><p>but I was getting the following error<br/>testStandardResourceManager(com.imilia.bkf.service.QueryServiceTest)  Time elapsed: 0.054 sec  <<< ERROR!<br/>javax.persistence.PersistenceException: A type for discriminator value [0] was not found?<br/>at com.avaje.ebean.server.deploy.InheritInfo.readType(InheritInfo.java:155)<br/>at com.avaje.ebean.server.deploy.BeanPropertyAssocOne$Reference.readSet(BeanPropertyAssocOne.java:316)<br/>at com.avaje.ebean.server.deploy.BeanPropertyAssocOne.readSet(BeanPropertyAssocOne.java:218)<br/>at com.avaje.ebean.server.query.SqlTreeNodeBean.load(SqlTreeNodeBean.java:228)<br/>at com.avaje.ebean.server.query.CQuery.readRow(CQuery.java:513)<br/>at com.avaje.ebean.server.query.CQuery.readBeanInternal(CQuery.java:545)<br/>at com.avaje.ebean.server.query.CQuery.readTheRows(CQuery.java:629)<br/>at com.avaje.ebean.server.query.CQuery.readCollection(CQuery.java:613)<br/>at com.avaje.ebean.server.query.CQueryEngine.findMany(CQueryEngine.java:164)<br/>at com.avaje.ebean.server.query.DefaultOrmQueryEngine.findMany(DefaultOrmQueryEngine.java:87)<br/>at com.avaje.ebean.server.core.OrmQueryRequest.findSet(OrmQueryRequest.java:231)<br/>at com.avaje.ebean.server.core.DefaultServer.findSet(DefaultServer.java:1101)<br/>at com.avaje.ebean.server.deploy.BeanSetHelp.refresh(BeanSetHelp.java:81)<br/>at com.avaje.ebean.server.deploy.BeanPropertyAssocMany.refresh(BeanPropertyAssocMany.java:197)<br/>at com.avaje.ebean.server.core.DefaultServer.refreshManyInternal(DefaultServer.java:357)<br/>at com.avaje.ebean.server.core.DefaultServer.lazyLoadMany(DefaultServer.java:304)<br/>at com.avaje.ebean.common.BeanSet.init(BeanSet.java:136)<br/>at com.avaje.ebean.common.BeanSet.size(BeanSet.java:351)<br/>at java.util.ArrayList.<init>(ArrayList.java:133)<br/>at com.imilia.bkf.access.ServiceProvider.getResourcesSortedByOid(ServiceProvider.java:274)<br/>at com.imilia.bkf.service.QueryServiceTest.testStandardResourceManager(QueryServiceTest.ja</p><p>now the problem lies in the following code <br/>public InheritInfo readType(DbReadContext ctx) throws SQLException {</p><p><br/>String discValue = ctx.getRset().getString(ctx.nextRsetIndex());</p><p><br/>if (discValue == null){<br/>return null;<br/>}</p><p><br/>InheritInfo typeInfo = root.getType(discValue);<br/>if (typeInfo == null){<br/>        String m = "A type for discriminator value ["+discValue+"] was not found?";<br/>        throw new PersistenceException(m);<br/>    }</p><p><br/>return typeInfo;<br/>}</p><p>root.getType simply looks up the discMap using the String value discValue - which fails ("0" is not 0)<br/>The workaround was for me to use the DiscriminatorType.STRING - which works fine as you can probably understand</p></span></div></td>
</tr>

<tr>
<td colspan="6">&nbsp;</td>
</tr>
</table>

<div class="bugdetail-head">
<div style="float:right">
Rob 
15 Sep&nbsp;08:54
</div>
Fixed in HEAD
</div>
<div class="bugdetail-foot" style="clear:both;">
<p>Issue was different datatypes comparison in Map.<br/>Fixed in HEAD.</p>
</div>
<p></p>

<input type="hidden" name="f_bugid" value="154">


</div>






<div id="bugDetailForm" style="display:none;">

<div id="app.comp.BugDetailAddComp">

<h4>Add detail to this bug</h4>
<table>
<tr>
<td class="label" style="width:8em;"><span class="mandatory">*</span>Summary:</td>
<td><input class="txt wide90" type="text" id="f_title" name="f_title" value=""></td>
</tr>
<tr>
<td class="label" valign="top"><span class="mandatory">*</span>Details:</td>
<td><textarea class="wide90" name="f_body" rows="10" cols="30"></textarea></td>
</tr>

<tr>
<td class="label"></td>
<td>
&nbsp;
</td>
</tr>

</table>
<div class="buttons">
<input type="button" class="btn" value="Save" accesskey="s" onclick="woPost('app.comp.BugDetailAddComp','doPost');" >
<input type="button" class="btn" value="Cancel" accesskey="c" onclick="j('#bugDetailForm').hide();">
</div>

</div>

</div>
</div>
</div>
</div><!-- end of bodywrap -->

<div id="footwrap">
<div id="footmax">
<div id="foot">
<a href="/">home</a> | <a href="#top">back to top</a>
</div>
</div>
</div><!-- end of footwrap -->

<!-- layers -->
<div id="m1popxxx" class="popmenuchild">
<a href="/ebean/introduction.html">Introduction</a>
<a href="/doc/ebean-userguide.pdf">User Guide (pdf)</a>
<a href="/configure.html">Install/Configure</a>
<a href="/static/javadoc/pub/index.html">Public JavaDoc</a>
<a href="/whitepaper.html">Whitepapers</a>
</div>

<div id="m2pop" class="popmenuchild">
<a href="/forumdetail-1.html">General</a>
<a href="/forumdetail-2.html">Database Specific</a>
<a href="/forumdetail-3.html">Byte Code</a>
<a href="/forumdetail-4.html">Deployment Annotations</a>
<a href="/forumdetail-5.html">Features</a>
</div>

<div id="m3pop" class="popmenuchild">
<a href="/bug.html">Top Bugs</a>
<a href="/enh.html">Top Enhancements</a>
</div>


<div id="woResponse">woResponse</div>

</form>

<div id="attachmentUpload" class="popdialog">
<form action='/bugdetail-154.html' method="post" id="UPLOAD" enctype="multipart/form-data">
<input type="hidden" name="f_bugid" value="154">
<input type="hidden" name="WO_HANDLER" value="app.comp.BugAttachmentUploadHandler">
<h4>Upload a file</h4>
<p><input type='file' name='f_file' ></p>
<div class="buttons">
<input type='submit' name='_upload' value="Upload" > <input type='button' value='Cancel' onclick="popdialog.hide();">
</div>
</form>
</div>

<div id="woFocusDelay"></div>
</body>
</html>

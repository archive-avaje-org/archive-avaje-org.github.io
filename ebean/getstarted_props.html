<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Strict //EN">
<html>
<head>
<title>Get Started with Ebean</title>
<link rel="shortcut icon" href="/image/favicon.ico" >
<link rel="stylesheet" type="text/css" href="/static/v2style.css" >
<!--
<link rel="stylesheet" type="text/css" href="/css/100/basestyle|syntaxhighlighter" >
-->

<!--[if lt IE 7]>
<link rel="stylesheet" type="text/css" href="/doc/ie.css" media="screen">
<![endif]-->


<script type="text/javascript" src="/doc/jslib.js" ></script>
<!--
<script type="text/javascript" src="/jsl/jquery|jquery.corner|mygoo|app|shCore|shBrushJava|shBrushProperty|shBrushSql" ></script>
-->

<script type="text/javascript">
 $(document).ready(function(){
	$(".topic").corner("12px");
	$("a.action").corner("8px hover");
	$("div.example").corner("5px");
	$(".reqrlogin").hide();

	//dp.SyntaxHighlighter.ClipboardSwf = '/flash/clipboard.swf';
	dp.SyntaxHighlighter.HighlightAll('code');

 });
</script>

<!-- component('cn=app.comp.LoginEnable') -->



<style>
ul.main li {
list-style: none;
}
div.main h4 {
font-size:150%;
}
</style>


</head>

<body>
<form action='/ebean/getstarted_props.html' method="post" id="GLOBAL_ACTION">
<input type='hidden' name='_WOGA_CONTROLLER' >
<input type='hidden' name='_WOGA_METHOD' >
<input type='hidden' name='_WOGA_PARAM' >
<input type='hidden' name='_WOGA_RENDER' >
<a id="top"></a>
<div id="headwrap">
<div id="headmax">
<div id="menuuser">
<!-- component('cn=app.comp.UserStatus') -->
</div>
<img id="logo" src="/image/logo-avaje.gif" width="127" height="50" alt="avaje logo">
<div style="clear:both;"></div>
</div>
</div><!-- end of headwrap -->

<div id="head2wrap">
<div id="head2max">
<table summary="layout">
<tr>
<td align="center">
<div id="menutab" style="">
<a id="m0" href="/" class="popmenu"><span>home</span></a>
<a id="m1" href="/ebean/documentation.html" class="popmenu"><span>documentation</span></a>
<a id="m4" href="/download.html" class="popmenu"><span>downloads</span></a>
<a id="m6" href="http://groups.google.com/group/ebean" class="popmenu"><span>google group</span></a>
<a id="m2" href="/forum.html" class="popmenu"><span>forums<img src="/image/menuDownH6_3.gif" width="11" height="11" alt=""></span></a>
<a id="m3" href="/bug.html" class="popmenu"><span>bugs<img src="/image/menuDownH6_3.gif" width="11" height="11" alt=""></span></a>
<a id="m5" href="/feedback.html" class="popmenu"><span>feedback</span></a>
</div>
</td>
</tr>
</table>
</div>
</div>

<div id="bodywrap">
<div id="bodymax">
<div id="content">
<div id="pageBody">
<div id="breadcrumb">
<img src="/image/smallhome.gif"> <a href="/">Home</a>
&raquo; <a href="/">ebean</a>
&raquo; <a href="/ebean/documentation.html">docs</a>
&raquo; <span>Get Started with Ebean</span>
</div>





<div class="columnlayout">

<h4>Get Started with Ebean</h4>
<ul class="main">
<li><a href="#jar">1. Put ebean-x.jar and persistence.jar in your classpath</a></li>
<li><a href="#props">2. Configure ebean.properties file</a></li>
<li><a href="#test">3. Try a simple test</a></li>
<li><a href="#eb">4. Create an entity bean</a></li>
<li><a href="#ddl">5. Configure DDL generation</a></li>
<li><a href="#iud">6. Try to insert, update, query, delete</a></li>
<li><a href="#logs">7. Check the Transaction Logs</a></li>
</ul>

<div class="main">
<h4><a id="jar"></a>1. Put ebean-x.jar and persistence.jar in your classpath</h4>
<p>
You need to put the ebean and persistence jar in the classpath. You can do this manually
or via maven or ivy using the avaje.org maven repository. Goto the <a href="/download.html">DOWNLOAD</a> page
for details.
</p>
<h4><a id="props"></a>2. Configure ebean.properties file</h4>
<p>
create an ebean.properties file and put it in your classpath 
or working directory. You can use the example below as a 
starting point.
</p>
<p>
You need to change the DataSource parameters
to suite your own environment.
</p>
<div class="">
<pre class="property:nogutter:nocontrols">
# -------------------------------------------------------------
# Load (Dev/Test/Prod) properties external to your war/jar
# -------------------------------------------------------------
# You can use load.properties to load the properties from a
# file external to your war/jar. 
#load.properties.override=${CATALINA_HOME}/conf/myapp.ebean.properties


ebean.ddl.generate=false
ebean.ddl.run=false

ebean.debug.sql=true
ebean.debug.lazyload=false


# -------------------------------------------------------------
# Transaction Logging
# -------------------------------------------------------------

# Use java util logging to log transaction details
#ebean.loggingToJavaLogger=true

# General logging level: (none, explicit, all)
ebean.logging=all

# Sharing log files: (none, explicit, all)
ebean.logging.logfilesharing=all

# location of transaction logs 
ebean.logging.directory=logs
#ebean.logging.directory=${catalina.base}/logs/trans

# Specific Log levels (none, summary, binding, sql)
ebean.logging.iud=sql
ebean.logging.query=sql
ebean.logging.sqlquery=sql

ebean.logging.txnCommit=none

# -------------------------------------------------------------
# DataSources (If using default Ebean DataSourceFactory)
# ------------------------------------------------------------- 
# You can specify many DataSources (one per EbeanServer)  and 
# one of them is defined as the default/primary DataSource

# specify the default/primary DataSource
datasource.default=h2

datasource.h2.username=sa
datasource.h2.password=
datasource.h2.databaseUrl=jdbc:h2:mem:tests;DB_CLOSE_DELAY=-1
datasource.h2.databaseDriver=org.h2.Driver
datasource.h2.minConnections=1
datasource.h2.maxConnections=25
datasource.h2.heartbeatsql=select 1
datasource.h2.isolationlevel=read_committed

datasource.mysql.username=test
datasource.mysql.password=test
datasource.mysql.databaseUrl=jdbc:mysql://127.0.0.1:3306/test
datasource.mysql.databaseDriver=com.mysql.jdbc.Driver
datasource.mysql.minConnections=1
datasource.mysql.maxConnections=25
#datasource.mysql.heartbeatsql=select 1
datasource.mysql.isolationlevel=read_committed

#datasource.ora.username=test
#datasource.ora.password=test
#datasource.ora.databaseUrl=jdbc:oracle:thin:@127.0.0.1:1521:XE
#datasource.ora.databaseDriver=oracle.jdbc.driver.OracleDriver
#datasource.ora.minConnections=1
#datasource.ora.maxConnections=25
#datasource.ora.heartbeatsql=select count(*) from dual
#datasource.ora.isolationlevel=read_committed

#datasource.pg.username=test
#datasource.pg.password=test
#datasource.pg.databaseUrl=jdbc:postgresql://127.0.0.1:5433/test
#datasource.pg.databaseDriver=org.postgresql.Driver
#datasource.pg.heartbeatsql=select 1
</pre>
</div>

<h4><a id="test"></a>3. Try a simple test</h4>
<p>
Create a java class with a main method. Include code like that below
but use a table name in your environment.
</p>
<p>
This will test that Ebean can find and use the DataSource.
</p>

<div class="">
<pre class="java:nogutter:nocontrols">
package test.model;

import com.avaje.ebean.Ebean;
import com.avaje.ebean.SqlRow;
import com.avaje.ebean.config.GlobalProperties;

public class CheckDataSource {

	public static void main(String[] args) {
		
		String sql = "select count(*) as count from dual";
		SqlRow row = 
			Ebean.createSqlQuery(sql)
			.findUnique();
		
		Integer i = row.getInteger("count");
		
		System.out.println("Got "+i+"  - DataSource good.");
	}
}
</pre>
</div>

<h4><a id="eb"></a>4. Create an entity bean</h4>
<p>
Create a very simple entity bean.
</p>
<div class="">
<pre class="java:nogutter:nocontrols">
package test.model;

import java.sql.Timestamp;

import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Table;
import javax.persistence.Version;

/**
 * A simple entity bean. This table does not have to exist if
 * you use Ebean's DDL generation.
 */
@Entity
@Table(name="e_junktable")
public class EBasicVer {
    
    @Id
    Integer id;
    
    String name;
    
    String description;
    
    @Version
    Timestamp lastUpdate;
    
    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public Timestamp getLastUpdate() {
        return lastUpdate;
    }

    public void setLastUpdate(Timestamp lastUpdate) {
        this.lastUpdate = lastUpdate;
    }

}

</pre>
</div>

<h4><a id="ddl"></a>5. Configure DDL generation</h4>
<p>
Change ebean.properties to turn on DDL generation.
</p>
<div class="">
<pre class="property:nogutter:nocontrols">
# in ebean.properties
ebean.ddl.generate=true
ebean.ddl.run=true
</pre>
</div>
<p>
The next time Ebean is run it will generate the DDL and run it.
This includes drop table statements which will fail on first run.
</p>
<h4><a id="iud"></a>6. Try to insert, update, query, delete</h4>

<div class="">
<pre class="java:nogutter:nocontrols">
package test;

import test.model.ESimple;

import com.avaje.ebean.Ebean;
import com.avaje.ebean.config.GlobalProperties;


public class CheckIUDAndQuery {

	public static void main(String[] args) {
		
		//System.setProperty("catalina.base", "D:/apps/tomcat6");
		//System.setProperty("ebean.props.file", "D:/apps/tomcat6/conf/zsite.ebean.properties");
		//GlobalProperties.put("ebean.debug.sql", "true");
		
		ESimple e = new ESimple();
		e.setName("test");
		e.setDescription("something");
		
		// will insert
		Ebean.save(e);
		
		e.setDescription("changed");
		
		// this will update
		Ebean.save(e);
		
		// find the inserted entity by its id
		ESimple e2 = Ebean.find(ESimple.class, e.getId());
		System.out.println("Got "+e2.getDescription());
		
		Ebean.delete(e);
		// can use delete by id when you don't have the bean
		//Ebean.delete(ESimple.class, e.getId());
		
	}
}
</pre>
</div>

<h4><a id="logs"></a>7. Check Transaction logs</h4>
<p>
After this you should find the 'transaction logs' and have a look so that
you can see the statements Ebean generated and the bind values used etc.
</p>
<pre class="java:nogutter:nocontrols">
...
1/03/2010 08:51:39 com.avaje.ebean.server.transaction.TransactionLogManager &lt;init&gt;
INFO: Transaction logs in: D:/apps/tomcat6/logs/trans
...
</pre>
<p>
Ebean will log out the directory where the transaction logs are getting written to.
You should see something like the above in your logs.
</p>
<p>
When you find the transaction logs you should find content like the snippet shown below.
This shows you the transaction ids and the statements, bind values and a summary entry.
The transaction logs are very useful for you to follow exactly what Ebean is doing.
</p>

<div>
<pre class="java:nogutter:nocontrols">
trans[1001], 08:51:39.430, insert into e_basicver (name, description, last_update) values (?,?,?) 
trans[1001], 08:51:39.508, Binding Insert [e_basicver]  set[name=test, description=something, lastUpdate=2010-03-01 08:51:39.502, ] 
trans[1001], 08:51:39.510, Inserted [ESimple] [1] 
trans[1002], 08:51:39.514, update e_basicver set name=?, description=?, last_update=? where id=? and last_update=? 
trans[1002], 08:51:39.516, Binding Update [e_basicver]  set[name=test, description=changed, lastUpdate=2010-03-01 08:51:39.515, ] where[id=1, lastUpdate=2010-03-01 08:51:39.502, ] 
trans[1002], 08:51:39.548, Updated [ESimple] [1] 
trans[1003], 08:51:39.579, select e.id c0, e.name c1, e.description c2, e.last_update c3  from e_basicver e where e.id = ?   
trans[1003], 08:51:39.585, FindById exeMicros[4530] rows[1] type[ESimple] bind[1] 
trans[1004], 08:51:39.587, delete from e_basicver where id=? and last_update=? 
trans[1004], 08:51:39.587, Binding Delete [e_basicver] where[id=1, lastUpdate=2010-03-01 08:51:39.515, ] 
trans[1004], 08:51:39.587, Deleted [ESimple] [1] 
</pre>
</div>

</div>

<div class="colnext">
<a class="h3" href="/ebean/getstarted_programmatic.html">Next: Programmatic Configuration</a>
</div>

</div>

</div>
</div>
</div>
</div><!-- end of bodywrap -->

<div id="footwrap">
<div id="footmax">
<div id="foot">
<a href="/">home</a> | <a href="#top">back to top</a>
</div>
</div>
</div><!-- end of footwrap -->

<!-- layers -->
<div id="m1popxxx" class="popmenuchild">
<a href="/ebean/introduction.html">Introduction</a>
<a href="/doc/ebean-userguide.pdf">User Guide (pdf)</a>
<a href="/configure.html">Install/Configure</a>
<a href="/static/javadoc/pub/index.html">Public JavaDoc</a>
<a href="/whitepaper.html">Whitepapers</a>
</div>

<div id="m2pop" class="popmenuchild">
<a href="/forumdetail-1.html">General</a>
<a href="/forumdetail-2.html">Database Specific</a>
<a href="/forumdetail-3.html">Byte Code</a>
<a href="/forumdetail-4.html">Deployment Annotations</a>
<a href="/forumdetail-5.html">Features</a>
</div>

<div id="m3pop" class="popmenuchild">
<a href="/bug.html">Top Bugs</a>
<a href="/enh.html">Top Enhancements</a>
</div>


<div id="woResponse">woResponse</div>

</form>

<div id="woFocusDelay"></div>
</body>
</html>

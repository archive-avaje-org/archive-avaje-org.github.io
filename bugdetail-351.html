<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Strict //EN">
<html>
<head>
<title>Bug: ENHANCEMENT - Add support for OneToMany JoinTables</title>
<link rel="shortcut icon" href="/image/favicon.ico" >
<link rel="stylesheet" type="text/css" href="/static/v2style.css" >
<!--
<link rel="stylesheet" type="text/css" href="/css/100/basestyle|syntaxhighlighter" >
-->

<!--[if lt IE 7]>
<link rel="stylesheet" type="text/css" href="/doc/ie.css" media="screen">
<![endif]-->


<meta name="Author" content="Rob">
<meta name="description" content="Refer http www java2s com Tutorial Java 0355 JPA OneToManyJoinTableSetup htm Hi all On further investigation I m pretty sure that what I m trying to do is legit It s a unidirectional oneToMany and I can see some examples of using JPA to set it up http www java2s com Tutorial Java 0355 JPA OneToManyJoinTableSetup htm http tadtech blogspot com 2007 09 hibernate annotation one to many join html In Hibernate for example unidirectional appears to be the preferred option I thought it might be that the Car had to specify all the details of the join so I tried this OneToMany cascade CascadeType ALL PrivateOwned JoinTable name car wheels joinColumns JoinColumn name car id referencedColumnName id inverseJoinColumns JoinColumn name wheel id referencedColumnName id private List wheels new ArrayList bu">

<script type="text/javascript" src="/doc/jslib.js" ></script>
<!--
<script type="text/javascript" src="/jsl/jquery|jquery.corner|mygoo|app|shCore|shBrushJava|shBrushProperty|shBrushSql" ></script>
-->

<script type="text/javascript">
 $(document).ready(function(){
	$(".topic").corner("12px");
	$("a.action").corner("8px hover");
	$("div.example").corner("5px");
	$(".reqrlogin").hide();

	//dp.SyntaxHighlighter.ClipboardSwf = '/flash/clipboard.swf';
	dp.SyntaxHighlighter.HighlightAll('code');

 });
</script>

<!-- component('cn=app.comp.LoginEnable') -->




</head>

<body>
<form action='/bugdetail-351.html' method="post" id="GLOBAL_ACTION">
<input type='hidden' name='_WOGA_CONTROLLER' >
<input type='hidden' name='_WOGA_METHOD' >
<input type='hidden' name='_WOGA_PARAM' >
<input type='hidden' name='_WOGA_RENDER' >
<a id="top"></a>
<div id="headwrap">
<div id="headmax">
<div id="menuuser">
<!-- component('cn=app.comp.UserStatus') -->
</div>
<img id="logo" src="/image/logo-avaje.gif" width="127" height="50" alt="avaje logo">
<div style="clear:both;"></div>
</div>
</div><!-- end of headwrap -->

<div id="head2wrap">
<div id="head2max">
<table summary="layout">
<tr>
<td align="center">
<div id="menutab" style="">
<a id="m0" href="/" class="popmenu"><span>home</span></a>
<a id="m1" href="/ebean/documentation.html" class="popmenu"><span>documentation</span></a>
<a id="m4" href="/download.html" class="popmenu"><span>downloads</span></a>
<a id="m6" href="http://groups.google.com/group/ebean" class="popmenu"><span>google group</span></a>
<a id="m2" href="/forum.html" class="popmenu"><span>forums<img src="/image/menuDownH6_3.gif" width="11" height="11" alt=""></span></a>
<a id="m3" href="/bug.html" class="popmenu"><span>bugs<img src="/image/menuDownH6_3.gif" width="11" height="11" alt=""></span></a>
<a id="m5" href="/feedback.html" class="popmenu"><span>feedback</span></a>
</div>
</td>
</tr>
</table>
</div>
</div>

<div id="bodywrap">
<div id="bodymax">
<div id="content">
<div id="pageBody">
<div id="breadcrumb">
&nbsp;
</div>






<div class="breadcrumb">
<img src="/image/smallhome.gif"> <a href="index.html">Home</a> &raquo; <a href="bug.html">Bugs</a> &raquo; ENH 351 : ENHANCEMENT - Add support for OneToMany JoinTables
</div>


<!-- bug header info -->




<div id="app.comp.BugDetailComp">

<div class="pageactions">
<!--
<input type="button" style="width:12em;" class="btn requser" value="Add Comment" onclick="j('#bugDetailForm').show();j('#f_title').focus();">
<input type="button" style="width:12em;" class="btn requser" value="Create a new Bug" onclick="gotoURL('bugnew.html');">
-->
</div>

<table class="formlayout">
<tr>
<td colspan="6" class="heading">&nbsp;<span class="xheading">Enhancement 351 : ENHANCEMENT - Add support for OneToMany JoinTables </span></td>
</tr>
<tr>
<td width="15%" class="label">Priority&nbsp;</td><td><div class="fieldmargin"><span class="field">High</span></div></td>
<td class="label">Reported Version&nbsp;</td><td><div class="fieldmargin"><span class="field">&nbsp;</span></div></td>
<td class="label">Logged By&nbsp;</td><td><div class="fieldmargin"><span class="field">Rob</span></div></td>
</tr>

<tr>
<td class="label">Status&nbsp;</td><td><div class="fieldmargin"><span class="field">Fixed</span></div></td>
<td class="label">Fixed Version&nbsp;</td><td><div class="fieldmargin"><span class="field">github</span></div></td>
<td class="label">Assigned To&nbsp;</td><td><div class="fieldmargin"><span class="field">&nbsp;</span></div></td>
</tr>

<tr>
<td class="label">Product&nbsp;</td><td><div class="fieldmargin"><span class="field">Ebean - core</span></div></td>
<td class="label">Duplicate Of&nbsp;</td><td><div class="fieldmargin"><span class="field">&nbsp;</span></div></td>
<td class="label">Created&nbsp;</td><td><div class="fieldmargin"><span class="field">26/01/2011</span></div></td>
</tr>

<tr>
<td class="label">Updated&nbsp;</td><td><div class="fieldmargin"><span class="field">26/01/2011</span></div></td>
<td class="label">Type&nbsp;</td><td><div class="fieldmargin"><span class="field">Enhancement</span></div></td>
<td class="label">&nbsp;</td><td></td>
</tr>

<tr>
<td class="label">Attachments&nbsp;</td>
<td colspan="5">
<div class="attachments">
<div class="fieldmargin">
<span class="field" style="width:100%;">
No attachments</span>
</div>
</div>
</td>
</tr>

<tr>
<td colspan="6"><div class="fieldmargin"><span class="field"><p>Refer:<br/><a href="http://www.java2s.com/Tutorial/Java/0355__JPA/OneToManyJoinTableSetup.htm">http://www.java2s.com/Tutorial/Java/0355__JPA/OneToManyJoinTableSetup.htm</a></p><p>Hi all,</p><p>On further investigation, I'm pretty sure that what I'm trying to do<br/>is legit.  It's a unidirectional oneToMany and I can see some examples<br/>of using JPA to set it up:</p><p><a href="http://www.java2s.com/Tutorial/Java/0355__JPA/OneToManyJoinTableSetup.htm">http://www.java2s.com/Tutorial/Java/0355__JPA/OneToManyJoinTableSetup.htm</a><br/><a href="http://tadtech.blogspot.com/2007/09/hibernate-annotation-one-to-many-join.html">http://tadtech.blogspot.com/2007/09/hibernate-annotation-one-to-many-join.html</a></p><p>In Hibernate, for example, unidirectional appears to be the preferred<br/>option.</p><p>I thought it might be that the Car had to specify all the details of<br/>the join, so I tried this:</p><p><br/>   @OneToMany(cascade=CascadeType.ALL)<br/>   @PrivateOwned<br/>   @JoinTable(name="car_wheels",<br/>               joinColumns= {<br/>                       @JoinColumn(name="car_id", referencedColumnName="id")<br/>               },<br/>               inverseJoinColumns = {<br/>                       @JoinColumn(name="wheel_id", referencedColumnName="id")<br/>               }<br/>       )<br/>   private List<TestWheel> wheels = new ArrayList<TestWheel>();</p><p>...but I still get an exception:</p><p>java.lang.RuntimeException: Null Getter for: TestWheel.test_car<br/>       at<br/>com.avaje.ebean.server.deploy.BeanProperty.<init>(BeanProperty.java:<br/>276)<br/>       at<br/>com.avaje.ebean.server.deploy.BeanPropertyAssoc.<init>(BeanPropertyAssoc.java:<br/>93)<br/>       at<br/>com.avaje.ebean.server.deploy.BeanPropertyAssocOne.<init>(BeanPropertyAssocOne.java:<br/>69)<br/>       at<br/>com.avaje.ebean.server.deploy.meta.DeployBeanPropertyLists.<init>(DeployBeanPropertyLists.java:<br/>83)<br/>       at<br/>com.avaje.ebean.server.deploy.BeanDescriptor.<init>(BeanDescriptor.java:<br/>425)<br/>       at<br/>com.avaje.ebean.server.deploy.BeanDescriptorManager.readEntityRelationships(BeanDescriptorManager.java:<br/>587)<br/>       at<br/>com.avaje.ebean.server.deploy.BeanDescriptorManager.deploy(BeanDescriptorManager.java:<br/>245)<br/>       at<br/>com.avaje.ebean.server.core.InternalConfiguration.<init>(InternalConfiguration.java:<br/>134)<br/>       at<br/>com.avaje.ebean.server.core.DefaultServerFactory.createServer(DefaultServerFactory.java:<br/>168)<br/>       at<br/>com.avaje.ebean.server.core.DefaultServerFactory.createServer(DefaultServerFactory.java:<br/>104)<br/>       at<br/>com.avaje.ebean.server.core.DefaultServerFactory.createServer(DefaultServerFactory.java:<br/>67)<br/>       at com.avaje.ebean.EbeanServerFactory.create(EbeanServerFactory.java:<br/>63)<br/>       at com.avaje.ebean.Ebean$ServerManager.getWithCreate(Ebean.java:226)<br/>       at com.avaje.ebean.Ebean$ServerManager.get(Ebean.java:213)<br/>       at com.avaje.ebean.Ebean$ServerManager.access$1(Ebean.java:203)<br/>       at com.avaje.ebean.Ebean.getServer(Ebean.java:277)</p><p><br/>So... I'm starting to think this is a bug, or missing functionality in<br/>Ebean?  Or have I misunderstood?  I'm using 2.3.</p><p>Thanks,<br/>Alastair</p></span></div></td>
</tr>

<tr>
<td colspan="6">&nbsp;</td>
</tr>
</table>

<div class="bugdetail-head">
<div style="float:right">
Saulius 
05 Jul&nbsp;15:10
</div>
Same problem here
</div>
<div class="bugdetail-foot" style="clear:both;">
<p>I've run into exactly the same problem. It seems Ebean does not interpret @JoinTable right.</p><p>I have entities:</p><p>@Entity<br/>@Table(name = "hotel_room")<br/>public class HotelRoom {</p><p>	....(id and version)....<br/>	<br/>	@OneToMany(cascade = CascadeType.ALL)<br/>	@JoinTable(name = "offsite_hotel_room_pax", joinColumns = @JoinColumn(name="room"), inverseJoinColumns = @JoinColumn(name = "passenger"))<br/>	private List<Passenger> pax;</p><p>	....(getters and setters)....<br/>}</p><p>@Entity<br/>@Table(name = "passenger")<br/>public class Passenger {</p><p>	....(id and version)....</p><p>	protected String firstname;<br/>	<br/>	protected String lastname;</p><p>	....(getters and setters)....<br/>}</p><p>Whenever I select hotel room:</p><p>	HotelRoom room = Ebean.find(OffsiteHotelRoom.class, 31841804);</p><p>I get error:</p><p>javax.persistence.PersistenceException: Query threw SQLException:ERROR: column t1.room does not exist <br/>Bind values:[31841804] <br/>Query was:<br/>select t0.id as c0, t1.id as c1, t1.firstname as c2, t1.lastname as c3, t1.version as c4 <br/>from offsite_hotel_room t0<br/>left outer join passenger t1 on t1.room = t0.id  <br/>where t0.id = ?   <br/>order by t0.id </p><p><br/>	at com.avaje.ebeaninternal.server.query.CQuery.createPersistenceException(CQuery.java:849)<br/>	at com.avaje.ebeaninternal.server.query.CQuery.createPersistenceException(CQuery.java:829)<br/>	at com.avaje.ebeaninternal.server.query.CQueryEngine.findMany(CQueryEngine.java:238)<br/>	at com.avaje.ebeaninternal.server.query.DefaultOrmQueryEngine.findMany(DefaultOrmQueryEngine.java:104)<br/>	at com.avaje.ebeaninternal.server.core.OrmQueryRequest.findList(OrmQueryRequest.java:344)<br/>	at com.avaje.ebeaninternal.server.core.DefaultServer.findList(DefaultServer.java:1469)<br/>	at com.avaje.ebeaninternal.server.core.DefaultBeanLoader.loadMany(DefaultBeanLoader.java:162)<br/>	at com.avaje.ebeaninternal.server.core.DefaultServer.loadMany(DefaultServer.java:511)<br/>	at com.avaje.ebeaninternal.server.loadcontext.DLoadManyContext.loadMany(DLoadManyContext.java:142)<br/>	at com.avaje.ebean.common.AbstractBeanCollection.lazyLoadCollection(AbstractBeanCollection.java:153)<br/>	at com.avaje.ebean.common.BeanList.init(BeanList.java:116)<br/>	at com.avaje.ebean.common.BeanList.size(BeanList.java:410)<br/>	at lt.travelonline.Utils.getCollectionSize(Utils.java:1448)<br/>	at lt.travelonline.Utils.getSize(Utils.java:1513)<br/>	at lt.travelonline.test.EbeanTest.testJoinTable(EbeanTest.java:136)</p>
</div>
<p></p>
<div class="bugdetail-head">
<div style="float:right">
Bence 
08 Aug&nbsp;08:17
</div>
vote
</div>
<div class="bugdetail-foot" style="clear:both;">
<p>+1</p>
</div>
<p></p>

<input type="hidden" name="f_bugid" value="351">


</div>






<div id="bugDetailForm" style="display:none;">

<div id="app.comp.BugDetailAddComp">

<h4>Add detail to this bug</h4>
<table>
<tr>
<td class="label" style="width:8em;"><span class="mandatory">*</span>Summary:</td>
<td><input class="txt wide90" type="text" id="f_title" name="f_title" value=""></td>
</tr>
<tr>
<td class="label" valign="top"><span class="mandatory">*</span>Details:</td>
<td><textarea class="wide90" name="f_body" rows="10" cols="30"></textarea></td>
</tr>

<tr>
<td class="label"></td>
<td>
&nbsp;
</td>
</tr>

</table>
<div class="buttons">
<input type="button" class="btn" value="Save" accesskey="s" onclick="woPost('app.comp.BugDetailAddComp','doPost');" >
<input type="button" class="btn" value="Cancel" accesskey="c" onclick="j('#bugDetailForm').hide();">
</div>

</div>

</div>
</div>
</div>
</div><!-- end of bodywrap -->

<div id="footwrap">
<div id="footmax">
<div id="foot">
<a href="/">home</a> | <a href="#top">back to top</a>
</div>
</div>
</div><!-- end of footwrap -->

<!-- layers -->
<div id="m1popxxx" class="popmenuchild">
<a href="/ebean/introduction.html">Introduction</a>
<a href="/doc/ebean-userguide.pdf">User Guide (pdf)</a>
<a href="/configure.html">Install/Configure</a>
<a href="/static/javadoc/pub/index.html">Public JavaDoc</a>
<a href="/whitepaper.html">Whitepapers</a>
</div>

<div id="m2pop" class="popmenuchild">
<a href="/forumdetail-1.html">General</a>
<a href="/forumdetail-2.html">Database Specific</a>
<a href="/forumdetail-3.html">Byte Code</a>
<a href="/forumdetail-4.html">Deployment Annotations</a>
<a href="/forumdetail-5.html">Features</a>
</div>

<div id="m3pop" class="popmenuchild">
<a href="/bug.html">Top Bugs</a>
<a href="/enh.html">Top Enhancements</a>
</div>


<div id="woResponse">woResponse</div>

</form>

<div id="attachmentUpload" class="popdialog">
<form action='/bugdetail-351.html' method="post" id="UPLOAD" enctype="multipart/form-data">
<input type="hidden" name="f_bugid" value="351">
<input type="hidden" name="WO_HANDLER" value="app.comp.BugAttachmentUploadHandler">
<h4>Upload a file</h4>
<p><input type='file' name='f_file' ></p>
<div class="buttons">
<input type='submit' name='_upload' value="Upload" > <input type='button' value='Cancel' onclick="popdialog.hide();">
</div>
</form>
</div>

<div id="woFocusDelay"></div>
</body>
</html>
